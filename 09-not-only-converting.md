# 不仅能转码

FFmpeg 能够被用来进行简单或复杂的视频转码，可它的功能并不仅限于此。在这一章，我将介绍 FFmpeg 能做的几个实用的工作。

不过值得注意的是，下面涉及的一些概念可能需要较强的逻辑能力，所以请确保前面的章节都已经读过再开始阅读本章。

<a name="merge-two-videos"></a>
## 合并两段视频

视频能够被切割，那也能够被合并。这里说的“合并”就是指将视频头尾连接起来，比如我有两段视频，一个是 10 秒，另一个 20 秒，合并起来就是 30 秒。

要合并视频，首先我们得创建一个文本文件，叫什么名字都可以，我这里以 `list.txt` 为例。用任意一种你喜欢的文本编辑器，按顺序逐行写上 `file <file name>` ，比如我要将 `01.mp4` 与 `02.mp4` 合并起来，就写上这些内容：

	file 01.mp4
	file 02.mp4

注意如果文件名包含空格，则必须用 **单引号** 将文件名包起来，比如 `file 'file name with space.mp4'` 。  
我不确定它能不能使用中文的文件名，特别是在[字符集、编码混乱](http://www.zhihu.com/question/20650946)的 Windows 中，所以为了保险起见，尽量使用英文的文件名。

保存好 `list.txt` 之后，就可以在命令行中执行 `ffmpeg -f concat -i list.txt -c copy 输出文件名` 了。如果一切顺利，最后的输出文件就会是 `list.txt` 中所写的文件按顺序连接起来的成果。

这样做有一条限制，那就是被合并的视频必须都是一样编码、一样封装格式的，如果你想合并不同编码的视频，最好先转换成统一的编码。

当然，你也可以用同样的方式合并不止两个视频，要这样做，只要在列表的文本文件中（也就是上述的 `list.txt` ）多写几行就可以了，比如：

	file 'first file.mp4'
	file 'second file.mp4'
	file 'third file.mp4'
	...

<a name="batch-process"></a>
## 批量处理

命令行工具的一大好处就是它可以很方便地被写进脚本中，以此进行批量处理，在 GNU/Linux 和 Mac OS X 上，你可以创建一个文本文件，随便取个名字，在里面逐行写上想要执行的命令，比如：

	ffmpeg -i a.mp4 a.mkv
	ffmpeg -i b.mp4 b.mkv

之后用 `sh 脚本文件名` 执行这个脚本，它就会依次执行 `ffmpeg -i a.mp4 a.mkv` 和 `ffmpeg -i b.mp4 b.mkv` 两条命令了。

在 Microsoft Windows 中也是如此，不过文件名必须得以 `.bat` 结尾，并且以双击的方式来执行脚本。

你也可以在脚本中使用 “for 循环” 来对许多文件名有规律的媒体文件进行转码，比如像这样（仅限 GNU/Linux 和 Max OS X ）：

	for i in "听爸爸的话 第{01..04}话"; do
		ffmpeg -i "${i}.mkv" -c copy "${i}.mp4"
	done

就会把 “听爸爸的话” 第 01 到 04 话从 MKV 转到 MP4 封装格式。不过因为这东西不属于 FFmpeg 的范畴，所以我在这里不打算详细说明，按照上面的例子生搬硬套也应该能满足大部分需求。
